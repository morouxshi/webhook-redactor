/*! webhook-redactor - v0.0.1 - 2013-09-04
* https://github.com/gpbmike/webhook-redactor
* Copyright (c) 2013 Mike Horn; Licensed MIT */
(function(t){"use strict";window.RedactorPlugins=window.RedactorPlugins||{};var e=function(t){this.redactor=t,this.observe()};e.prototype={observe:function(){this.redactor.$editor.on("keyup.redactor",t.proxy(function(t){t.which===this.redactor.keyCode.ENTER&&this.checkNode(this.redactor.$editor.get(0))},this))},checkNode:function(e){return t.each(e.childNodes,t.proxy(function(e,o){if(3===o.nodeType&&o.nodeValue&&o.nodeValue.match(/((http:\/\/(.*youtube\.com\/watch.*|.*\.youtube\.com\/v\/.*|youtu\.be\/.*|.*\.youtube\.com\/user\/.*|.*\.youtube\.com\/.*#.*\/.*|m\.youtube\.com\/watch.*|m\.youtube\.com\/index.*|.*\.youtube\.com\/profile.*|.*\.youtube\.com\/view_play_list.*|.*\.youtube\.com\/playlist.*|www\.vimeo\.com\/groups\/.*\/videos\/.*|www\.vimeo\.com\/.*|vimeo\.com\/groups\/.*\/videos\/.*|vimeo\.com\/.*|vimeo\.com\/m\/#\/.*|player\.vimeo\.com\/.*))|(https:\/\/(.*youtube\.com\/watch.*|.*\.youtube\.com\/v\/.*|www\.vimeo\.com\/.*|vimeo\.com\/.*|player\.vimeo\.com\/.*)))/i)){var s=o.nodeValue,i=t("<span>loading...</span>");t(o).replaceWith(i),t.embedly.oembed(s).done(function(e){t.each(e,function(){i.replaceWith(this.html)})})}else 1!==o.nodeType||/^(a|button|textarea)$/i.test(o.tagName)||this.checkNode(o)},this)),this.matches}},window.RedactorPlugins.autoembedly={init:function(){this.autoembedly=new e(this)}}})(jQuery),function(t){"use strict";var e=function(t){this.redactor=t,this.init()};e.prototype={init:function(){this.removeEmptyPs()},removeEmptyPs:function(){this.redactor.$editor.find("p").each(function(){var e=t(this);e.html().replace(/\s|&nbsp;/g,"").length||e.remove()})}},window.RedactorPlugins=window.RedactorPlugins||{},window.RedactorPlugins.cleanup={init:function(){this.cleanup=new e(this)}}}(jQuery),function(t){"use strict";var e=function(e){this.redactor=e,this.$window=t(e.window),this.$window.on("scroll",t.proxy(this.checkOffset,this))};e.prototype={checkOffset:function(){0>=this.redactor.$box.offset().top-this.$window.scrollTop()?this.fix():this.unfix()},fix:function(){var t=parseInt(this.redactor.$box.css("border-left-width").replace("px",""),10);this.redactor.$toolbar.css({position:"fixed",left:this.redactor.$box.offset().left+t,width:this.redactor.$box.width(),zIndex:1}),this.redactor.$editor.css("padding-top",this.redactor.$toolbar.height()+10)},unfix:function(){this.redactor.$toolbar.css({position:"relative",left:"auto",width:"auto"}),this.redactor.$editor.css("padding-top",10)}},window.RedactorPlugins=window.RedactorPlugins||{},window.RedactorPlugins.fixedtoolbar={init:function(){this.fixedtoolbar=new e(this)}}}(jQuery),function(t){"use strict";window.RedactorPlugins=window.RedactorPlugins||{},window.RedactorPlugins.fullscreen={init:function(){this.fullscreen=!1,this.buttonAdd("fullscreen","Fullscreen",t.proxy(this.toggleFullscreen,this)),this.buttonSetRight("fullscreen"),this.opts.fullscreen&&this.toggleFullscreen()},toggleFullscreen:function(){var e;if(this.fullscreen){this.buttonRemoveIcon("fullscreen","normalscreen"),this.buttonInactive("fullscreen"),this.fullscreen=!1,t(window).off("resize",t.proxy(this.fullScreenResize,this)),t("body, html").css("overflow",""),this.$box.removeClass("redactor_box_fullscreen").css({width:"auto",height:"auto"}),this.opts.iframe&&(e=this.$editor.html()),this.tmpspan.after(this.$box).remove(),this.opts.iframe?this.fullscreenIframe(e):this.sync();var o=this.fsheight;this.opts.autoresize&&(o="auto"),this.opts.toolbarExternal&&(this.$box.css("top",this.boxcss.top),this.$toolbar.css({width:this.toolcss.width,top:this.toolcss.top,position:this.toolcss.position})),this.opts.iframe?this.$frame.css("height",o):this.$editor.css("height",o),this.$editor.css("height",o),this.focus(),this.observeStart()}else this.buttonChangeIcon("fullscreen","normalscreen"),this.buttonActive("fullscreen"),this.fullscreen=!0,this.opts.toolbarExternal&&(this.toolcss={},this.boxcss={},this.toolcss.width=this.$toolbar.css("width"),this.toolcss.top=this.$toolbar.css("top"),this.toolcss.position=this.$toolbar.css("position"),this.boxcss.top=this.$box.css("top")),this.fsheight=this.$editor.height(),this.opts.iframe&&(e=this.get()),this.tmpspan=t("<span></span>"),this.$box.addClass("redactor_box_fullscreen").after(this.tmpspan),t("body, html").css("overflow","hidden"),t("body").prepend(this.$box),this.opts.iframe&&this.fullscreenIframe(e),this.fullScreenResize(),t(window).resize(t.proxy(this.fullScreenResize,this)),t(document).scrollTop(0,0),this.focus(),this.observeStart()},fullscreenIframe:function(t){this.$editor=this.$frame.contents().find("body").attr({contenteditable:!0,dir:this.opts.direction}),this.$editor[0]&&(this.document=this.$editor[0].ownerDocument,this.window=this.document.defaultView||window),this.iframeAddCss(),this.opts.fullpage?this.setFullpageOnInit(t):this.set(t),this.opts.wym&&this.$editor.addClass("redactor_editor_wym")},fullScreenResize:function(){if(!this.fullscreen)return!1;var e=this.$toolbar.height(),o=this.$editor.css("padding-top").replace("px",""),s=t(window).height()-e;this.$box.width(t(window).width()-2).height(s+e),this.opts.toolbarExternal&&(this.$toolbar.css({top:"0px",position:"absolute",width:"100%"}),this.$box.css("top",e+"px")),this.opts.iframe?setTimeout(t.proxy(function(){this.$frame.height(s)},this),1):this.$editor.height(s-2*o),this.$editor.height(s)}}}(jQuery),function(t){"use strict";var e=function(t){this.redactor=t,this.$toolbars={},this.init()};e.prototype={control:{left:{classSuffix:"arrow-left"},up:{classSuffix:"arrow-up"},down:{classSuffix:"arrow-down"},right:{classSuffix:"arrow-right"},"|":{classSuffix:"divider"},remove:{classSuffix:"delete"},small:{classSuffix:"small",text:"S"},medium:{classSuffix:"medium",text:"M"},large:{classSuffix:"large",text:"L"},resize:{classSuffix:"resize-full"},row_up:{text:"Add row above"},row_down:{text:"Add row below"},col_left:{text:"Add column left"},col_right:{text:"Add column right"},add_head:{text:"Add header"},del_head:{text:"Delete header"},del_col:{text:"Delete column"},del_row:{text:"Delete row"},del_table:{text:"Delete table"},border:{text:"Bordered"},stripe:{text:"Striped"},full_border:{text:"Full border"}},init:function(){this.controlgroup={image:["left","up","down","right","|","small","medium","large","remove"],video:["up","down","|","resize","remove"],table:["up","down","|",{"Table Options":["row_up","row_down","col_left","col_right","|","add_head","del_head","|","del_col","del_row","del_table","|","border","stripe","full_border"]},"remove"]},this.observe()},observe:function(){this.redactor.$editor.on("mouseenter","figure",t.proxy(this.mouseenter,this)),this.redactor.$editor.on("mouseleave","figure",t.proxy(this.mouseleave,this)),this.redactor.$editor.on("mousedown",".wh-figure-controls",t.proxy(function(){this.current=this.redactor.getCurrent()},this)),this.redactor.$editor.on("click",".wh-figure-controls span, .wh-figure-controls a",t.proxy(function(e){e.stopPropagation(),this.command(t(e.currentTarget),t(e.currentTarget).closest("figure"))},this))},mouseenter:function(e){var o=t(e.currentTarget);t.each(["image","table","video"],t.proxy(function(t,e){o.hasClass("wh-figure-"+e)&&this.getToolbar(e).data("figure",o).prependTo(o)},this))},mouseleave:function(e){var o=t(e.currentTarget);o.find(".wh-figure-controls").appendTo(this.redactor.$box)},getToolbar:function(e){if(this.$toolbars[e])return this.$toolbars[e];var o=t('<div class="wh-figure-controls">');return t.each(this.controlgroup[e],t.proxy(function(e,s){var i;"string"==typeof s?(i=this.control[s],t("<span>",{"class":"wh-figure-controls-"+i.classSuffix,text:i.text}).data({command:s,control:i}).appendTo(o)):"object"==typeof s&&t.each(s,t.proxy(function(e,s){var r=t("<span>",{"class":"wh-figure-controls-table wh-dropdown",text:" "+e}).appendTo(o);t('<span class="caret">').appendTo(r);var n=t('<dl class="wh-dropdown-menu wh-dropdown-bubble wh-dropdown-arrow wh-dropdown-arrow-left">').appendTo(r);t.each(s,t.proxy(function(e,o){i=this.control[o],"|"===o?t('<dd class="divider">').appendTo(n):t("<a>",{text:i.text}).data({command:o,control:i}).appendTo(t("<dd>").appendTo(n))},this))},this))},this)),this.$toolbars[e]=o.appendTo(this.redactor.$editor)},command:function(e,o){var s=e.data("command"),i=function(t,e,o,s){var i=(s?".":"")+"wh-figure-"+(o||"");return i+t.join((e||" ")+i)},r=function(t,e){o.removeClass(i(t)).addClass("wh-figure-"+e)};switch(o.find(".wh-figure-controls").appendTo(this.redactor.$box),this.redactor.bufferSet(),s){case"up":o.insertBefore(o.prev());break;case"down":o.insertAfter(o.next());break;case"left":case"right":r(["left","right"],s),o.hasClass("wh-figure-medium")||o.hasClass("wh-figure-small")||o.addClass("wh-figure-medium");break;case"remove":o.remove();break;case"small":case"medium":case"large":r(["small","medium","large"],s),"large"===s&&o.removeClass(i(["left","right"])),e.addClass("on").siblings(i(["small","medium","large"],", ","controls-",!0)).removeClass("on");break;case"row_up":case"row_down":t.proxy(function(){var e=t(this.current).closest("tr"),o=e.clone().find("td").text("Data").end();"row_up"===s?o.insertBefore(e):o.insertAfter(e)},this)();break;case"col_left":case"col_right":t.proxy(function(){var e=t(this.current).closest("td"),o=e.closest("tr"),i=o.closest("table"),r=o.children().index(e)+1,n="col_left"===s?"before":"after";i.find("thead tr").children(":nth-child("+r+")")[n](t("<th>").text("Header")),i.find("tbody tr").children(":nth-child("+r+")")[n](t("<td>").text("Data"))},this)();break;case"add_head":t.proxy(function(){for(var e=o.find("tr").first().children().length,s=o.find("table"),i=t("<thead>").prependTo(s),r=t("<tr>").appendTo(i),n=0;e>n;n++)t("<th>").text("Header").appendTo(r)},this)();break;case"del_head":o.find("thead").remove();break;case"del_col":t.proxy(function(){var e=t(this.current).closest("td"),o=e.parent().children().index(e)+1;e.closest("table").find("tr").children(":nth-child("+o+")").remove()},this)();break;case"del_row":t(this.current).closest("tr").remove();break;case"del_table":o.remove();break;case"border":o.find("table").removeClass("wh-table-bordered-all").toggleClass("wh-table-bordered-rows");break;case"stripe":o.find("table").toggleClass("wh-table-striped");break;case"full_border":o.find("table").removeClass("wh-table-bordered-rows").toggleClass("wh-table-bordered-all");break;default:window.console.log(s)}}},window.RedactorPlugins=window.RedactorPlugins||{},window.RedactorPlugins.traverse={init:function(){this.traverse=new e(this)}}}(jQuery),function(t){t.fn.awesome=function(){return this.each(function(e){t(this).html("awesome"+e)})},t.awesome=function(e){return e=t.extend({},t.awesome.options,e),"awesome"+e.punctuation},t.awesome.options={punctuation:"."},t.expr[":"].awesome=function(e){return-1!==t(e).text().indexOf("awesome")}}(jQuery);